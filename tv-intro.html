<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- âœ… SEO: Intro soll nicht indexiert werden -->
  <meta name="robots" content="noindex,follow" />
  <!-- âœ… Canonical auf die eigentliche Startseite -->
  <link rel="canonical" href="https://www.b3nn3t.com/" />

  <title>TV-Intro â€“ b3nn3t | Intro-Annimation &amp; Visuals</title>
  <meta name="description" content="Das offizielle Intro von b3nn3t â€“ Sound, AtmosphÃ¤re und visuelle IdentitÃ¤t. Ein kurzer Einblick in die Welt hinter dem Intro." />

  <!-- (Optional) Spekulations-Regeln: Startseite vorladen/prerendern -->
  <script type="speculationrules">
  {
    "prefetch": [{ "source": "document", "urls": ["index.html"] }],
    "prerender": [{ "source": "document", "urls": ["index.html?nointro=1"] }]
  }
  </script>

  <style>
    :root {
      --fade-ms: 1000ms; /* Dauer der Ein-/Ausblendung */
      --bg: #930010;
    }

    html,body {
      margin:0;
      height:100%;
      background:var(--bg);
      overflow:hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    /* âœ… Canvas sichtbar (Tunnel-Grid) */
    canvas#c{
      position:fixed;
      inset:0;
      display:block;
      width:100vw;
      height:100vh;
      image-rendering:pixelated;
      image-rendering:crisp-edges;
      opacity:0;
      transition: opacity var(--fade-ms) ease;
      z-index:1;
    }
    body.ready canvas#c  { opacity:1; }  /* Fade-In */
    body.fadeout canvas#c{ opacity:0; }  /* Fade-Out */

    /* Skip-Button (Intro Ã¼berspringen) */
    .skip {
      position:fixed; top:14px; right:14px; z-index:10;
      background:#fff; color:#000; border:0; border-radius:999px;
      padding:.45rem .8rem; font-weight:700; cursor:pointer;
    }
    .skip:focus-visible { outline:2px solid #fff; outline-offset:2px; }

    /* âœ… Loader Overlay */
    .loaderWrap{
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      opacity:0;
      transition: opacity var(--fade-ms) ease;
      z-index:5;
      pointer-events:none;
    }
    body.ready .loaderWrap{ opacity:1; }     /* Fade-In */
    body.fadeout .loaderWrap{ opacity:0; }   /* Fade-Out */

    .loader{
      width:min(720px, 78vw);
      padding:18px 18px 16px;
      box-sizing:border-box;
    }

    /* âœ… 80s / eckig / CRT-Frame */
    .barFrame{
      width:100%;
      height:16px;
      border:2px solid #fff;
      border-radius:0;
      padding:2px;
      box-sizing:border-box;
      box-shadow:
        0 0 0 1px rgba(255,255,255,0.6),
        inset 0 0 0 1px rgba(0,0,0,0.6);
    }

    /* âœ… 80s Pixel-Fill */
    .bar{
      height:100%;
      width:0%;
      border-radius:0;
      background:
        repeating-linear-gradient(
          90deg,
          #fff 0px,
          #fff 6px,
          rgba(255,255,255,0.65) 6px,
          rgba(255,255,255,0.65) 8px
        );
    }

    .hint{
      margin-top:10px;
      color:rgba(255,255,255,.85);
      font-size:14px;
      letter-spacing:.2px;
      text-align:center;
      user-select:none;
    }

    /* Barrierefreiheit: Nutzer mit reduzierter Bewegung -> sofort weiter */
    @media (prefers-reduced-motion: reduce) {
      body { animation:none !important; }
      canvas#c, .loaderWrap { transition:none; }
    }
  </style>

  <!-- No-JS-Fallback: sofort weiterleiten -->
  <noscript>
    <meta http-equiv="refresh" content="0; url=index.html?nointro=1">
    <style>
      body { display:flex; align-items:center; justify-content:center; color:#fff; }
      a { color:#fff; text-decoration:underline; }
    </style>
    <p>Weiter zur <a href="index.html?nointro=1">Startseite</a>â€¦</p>
  </noscript>
</head>
<body>

  <!-- ðŸ”½ Hauptinhalt semantisch markiert -->
  <main role="main">
    <!-- Skip-Button -->
    <button class="skip" type="button" aria-label="Intro Ã¼berspringen">Skip</button>

    <!-- âœ… Tunnel Canvas -->
    <canvas id="c" aria-hidden="true"></canvas>

    <!-- âœ… Progress -->
    <div class="loaderWrap" aria-hidden="true">
      <div class="loader">
        <div class="barFrame">
          <div class="bar" id="bar"></div>
        </div>
        <div class="hint">Loadingâ€¦</div>
      </div>
    </div>

    <!-- Kurze Status-Anzeige fÃ¼r Screenreader -->
    <div aria-live="polite" style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;">
      Intro lÃ¤uft. Du kannst â€žSkipâ€œ drÃ¼cken, um direkt zur Startseite zu wechseln.
    </div>
  </main>

<script>
/* ================== Redirect Ziel (wie vorher) ================== */
const INTRO_RETURN_URL =
  (sessionStorage.getItem("introReturn") || "index.html") +
  (location.search.includes('nointro=1') ? "" : (location.search ? "&" : "?") + "nointro=1");

/* ================== PRELOAD bleibt drin ================== */
const preloadImages = [
  "assets/index/bennet_index1.avif",
  "assets/index/bennet_index1.webp",
  "assets/index/bennet_index2.avif",
  "assets/index/bennet_index2.webp",
  "assets/index/bennet_index3.avif",
  "assets/index/bennet_index3.webp",

  "assets/gesehen/insta1.webp",
  "assets/gesehen/insta2.webp",
  "assets/gesehen/insta3.webp",
  "assets/gesehen/insta4.webp",

  "assets/gesehen/reel1.avif",
  "assets/gesehen/reel2.avif",
  "assets/gesehen/reel3.avif",
  "assets/gesehen/reel4.avif",
  "assets/gesehen/reel5.avif",
  "assets/gesehen/reel6.avif",
  "assets/gesehen/reel7.avif",
  "assets/gesehen/instagram_poster.jpg",
  "https://img.youtube.com/vi/ZSaj_FuqPN8/hqdefault.jpg",
  "https://img.youtube.com/vi/DMNl40Tip1w/hqdefault.jpg",
  "https://img.youtube.com/vi/K5pKG0Smdfc/hqdefault.jpg",
  "https://img.youtube.com/vi/4I9vlcGvFGQ/hqdefault.jpg",
  "https://img.youtube.com/vi/w0pNdnlb96M/hqdefault.jpg",
  "https://img.youtube.com/vi/rV1U891RKLo/hqdefault.jpg",
  "https://img.youtube.com/vi/fq8zhAQMam0/hqdefault.jpg"
];

const preloadVideos = [ "assets/gesehen/B3NN3T.mp4" ];

function preloadAllImages(urls){
  urls.forEach(url=>{
    const img = new Image();
    img.referrerPolicy = "no-referrer";
    img.src = url;
  });
}

function preloadAllVideos(urls){
  urls.forEach(url=>{
    const v = document.createElement('video');
    v.preload = 'auto';
    v.muted = true;
    v.src = url;
    v.load();
  });
}

/* ðŸ”¥ Preload sofort beim Start */
if(!window._preloaded){
  window._preloaded=true;
  preloadAllImages(preloadImages);
  preloadAllVideos(preloadVideos);
}

/* ================== Canvas Setup ================== */
const c = document.getElementById('c');
const ctx = c.getContext('2d');

let W=0,H=0,DPR=1;

function resize(){
  DPR = Math.max(1, Math.floor(window.devicePixelRatio || 1));
  W = c.width  = Math.floor(innerWidth * DPR);
  H = c.height = Math.floor(innerHeight * DPR);
  c.style.width  = innerWidth + 'px';
  c.style.height = innerHeight + 'px';
  ctx.imageSmoothingEnabled = false;
}
addEventListener('resize', resize);
resize();

/* ================== Tunnel-Grid (4 Seiten, "Raum" in der Mitte) ================== */
function drawTunnelGrid(now, reveal01){
  // reveal01: 0..1 (wieviel "gezeichnet" werden soll)

  // Hintergrund
  ctx.setTransform(1,0,0,1,0,0);
  ctx.clearRect(0,0,W,H);
  ctx.fillStyle = '#930010';
  ctx.fillRect(0,0,W,H);

  // Pixel-snapping gegen Flimmern
  const snap = (v)=>Math.round(v);

  ctx.save();
  ctx.lineWidth = Math.max(1, Math.round(DPR));
  ctx.strokeStyle = 'rgba(0,0,0,0.30)';

  // Outer quad = volle FlÃ¤che
  const outer = [
    {x:0, y:0},   // TL
    {x:W, y:0},   // TR
    {x:W, y:H},   // BR
    {x:0, y:H}    // BL
  ];

  // Inner quad = "Raum" (Portal) in der Mitte
  const cx = W*0.5, cy = H*0.5;
  const innerW = W*0.42;
  const innerH = H*0.30;

  const inner = [
    {x:cx - innerW/2, y:cy - innerH/2}, // TL
    {x:cx + innerW/2, y:cy - innerH/2}, // TR
    {x:cx + innerW/2, y:cy + innerH/2}, // BR
    {x:cx - innerW/2, y:cy + innerH/2}  // BL
  ];

  // Helpers
  const lerp = (a,b,t)=>a+(b-a)*t;
  const lerpP = (A,B,t)=>({ x: lerp(A.x,B.x,t), y: lerp(A.y,B.y,t) });

  // "Strich-fÃ¼r-Strich": wie viele Elemente sichtbar?
  const RINGS = 30;  // Tiefe
  const RAD   = 22;  // Strahlen pro Seite

  const ringCount = Math.max(1, Math.floor(reveal01 * RINGS));
  const radCount  = Math.max(2, Math.floor(reveal01 * RAD));

  // Bewegung: wir verschieben die Ring-Indexierung (stabil, kein Zittern)
  const speed = 0.00035;
  const phase = (now*speed) % 1;

  // --- 1) Radiale Linien von allen vier Seiten ---
  // Oben & Unten
  for(let i=0;i<=radCount;i++){
    const t = i / radCount;

    // oben
    const A = { x: lerp(outer[0].x, outer[1].x, t), y: outer[0].y };
    const B = { x: lerp(inner[0].x, inner[1].x, t), y: inner[0].y };
    ctx.beginPath();
    ctx.moveTo(snap(A.x), snap(A.y));
    ctx.lineTo(snap(B.x), snap(B.y));
    ctx.stroke();

    // unten
    const C = { x: lerp(outer[3].x, outer[2].x, t), y: outer[3].y };
    const D = { x: lerp(inner[3].x, inner[2].x, t), y: inner[3].y };
    ctx.beginPath();
    ctx.moveTo(snap(C.x), snap(C.y));
    ctx.lineTo(snap(D.x), snap(D.y));
    ctx.stroke();
  }

  // Links & Rechts
  for(let i=0;i<=radCount;i++){
    const t = i / radCount;

    // links
    const A = { x: outer[0].x, y: lerp(outer[0].y, outer[3].y, t) };
    const B = { x: inner[0].x, y: lerp(inner[0].y, inner[3].y, t) };
    ctx.beginPath();
    ctx.moveTo(snap(A.x), snap(A.y));
    ctx.lineTo(snap(B.x), snap(B.y));
    ctx.stroke();

    // rechts
    const C = { x: outer[1].x, y: lerp(outer[1].y, outer[2].y, t) };
    const D = { x: inner[1].x, y: lerp(inner[1].y, inner[2].y, t) };
    ctx.beginPath();
    ctx.moveTo(snap(C.x), snap(C.y));
    ctx.lineTo(snap(D.x), snap(D.y));
    ctx.stroke();
  }

  // --- 2) Tiefen-Ringe (Quads) ---
  for(let i=0;i<ringCount;i++){
    const u = (i / (RINGS-1));

    // mehr Dichte Richtung Zentrum
    let z = u*u;

    // leicht "fahren": verschiebt die Tiefe, nicht die Geometrie
    z = (z + phase*0.18) % 1;
    z = z*z;

    const q0 = lerpP(outer[0], inner[0], z);
    const q1 = lerpP(outer[1], inner[1], z);
    const q2 = lerpP(outer[2], inner[2], z);
    const q3 = lerpP(outer[3], inner[3], z);

    ctx.beginPath();
    ctx.moveTo(snap(q0.x), snap(q0.y));
    ctx.lineTo(snap(q1.x), snap(q1.y));
    ctx.lineTo(snap(q2.x), snap(q2.y));
    ctx.lineTo(snap(q3.x), snap(q3.y));
    ctx.closePath();
    ctx.stroke();
  }

  // Inneres Frame etwas krÃ¤ftiger
  ctx.strokeStyle = 'rgba(0,0,0,0.45)';
  ctx.beginPath();
  ctx.moveTo(snap(inner[0].x), snap(inner[0].y));
  ctx.lineTo(snap(inner[1].x), snap(inner[1].y));
  ctx.lineTo(snap(inner[2].x), snap(inner[2].y));
  ctx.lineTo(snap(inner[3].x), snap(inner[3].y));
  ctx.closePath();
  ctx.stroke();

  ctx.restore();
}

/* ================== Loader Timing ================== */
const START_DELAY_MS = 1000;
const INTRO_MS = 3500;   // âœ… 3â€“4 Sekunden => 3.5s
const FADEOUT_MS = 1700;
const EXTRA_MS = 300;

let rafId = null;

function startTransition(){
  sessionStorage.setItem("introPlayed","1");
  document.body.classList.add('fadeout');
  setTimeout(()=>{ window.location.href = INTRO_RETURN_URL; }, FADEOUT_MS + EXTRA_MS);
}

function startProgressAndTunnel(){
  const bar = document.getElementById('bar');
  const start = performance.now();

  function frame(now){
    const t = (now - start) / INTRO_MS;
    const clamped = Math.max(0, Math.min(1, t));

    // Reveal: "Strich-fÃ¼r-Strich" Aufbau
    const reveal = Math.min(1, clamped * 1.15);

    // Tunnel zeichnen
    drawTunnelGrid(now, reveal);

    // Arcade-Steps (80s)
    const steps = 32;
    const stepped = Math.floor(clamped * steps) / steps;
    bar.style.width = (stepped * 100).toFixed(2) + "%";

    if(clamped >= 1){
      bar.style.width = "100%";
      startTransition();
      return;
    }
    rafId = requestAnimationFrame(frame);
  }
  rafId = requestAnimationFrame(frame);
}

/* ================== Skip & A11y ================== */
(function setupSkipAndA11y(){
  const skipBtn = document.querySelector('.skip');
  function goNow(){
    try { sessionStorage.setItem("introPlayed","1"); } catch(e){}
    document.body.classList.add('fadeout');
    setTimeout(()=>location.replace(INTRO_RETURN_URL), 250);
  }
  if (skipBtn) skipBtn.addEventListener('click', goNow);

  // Reduced motion => sofort weiter
  try {
    if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      goNow();
      return;
    }
  } catch(e){}
})();

/* ================== Start (wie vorher) ================== */
setTimeout(() => {
  document.body.classList.add('ready'); // sanft einblenden
  startProgressAndTunnel();             // Tunnel + Balken starten
}, START_DELAY_MS);
</script>
</body>
</html>

